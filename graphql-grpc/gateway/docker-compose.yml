version: '3.8' # Указание версии docker-compose. Версия 3.8 совместима с большинством новых фич Docker.

services:
  consul:
    image: hashicorp/consul:1.15 # Используется официальный образ Consul версии 1.15 от HashiCorp.
    container_name: consul-local # Явное указание имени контейнера для удобства в локальной разработке.

    ports:
      - "8500:8500"       # Открытие веб-интерфейса Consul для просмотра сервисов, состояния и ключей конфигурации.
      - "8600:8600/udp"   # Порт для DNS-запросов, если Consul используется как DNS-сервер для сервис-дискавери.

    command: agent -dev -client=0.0.0.0
    # Режим запуска агента Consul:
    # - `-dev`: режим разработки (без необходимости вручную создавать кластер, всё работает «из коробки»)
    # - `-client=0.0.0.0`: позволяет подключаться к Consul не только изнутри контейнера, но и снаружи (например, из других микросервисов)

    restart: unless-stopped
    # Контейнер будет перезапускаться при сбое или перезапуске Docker, но не при явной остановке пользователем.
